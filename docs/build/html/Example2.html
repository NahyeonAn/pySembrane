<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example 2: Rigorous evaluation of membrane gas separation process based on economic analysis &mdash; pySembrane 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example 3: Integrated process simulations with other processes for process level evaluation" href="Example3.html" />
    <link rel="prev" title="Example 1: Numerous membrane screening" href="Example1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #FFFFFF" >

          
          
          <a href="index.html">
            
              <img src="_static/pySembraneMain.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pySembrane.html">pySembrane</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Example1.html">Example 1: Numerous membrane screening</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example 2: Rigorous evaluation of membrane gas separation process based on economic analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-description">Example description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#method">Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results-analysis">Results analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sensitivity-analysis">Sensitivity analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#source-code">Source code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Example3.html">Example 3: Integrated process simulations with other processes for process level evaluation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Validation.html">Validation of pySembrane</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Citation.html">Citation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #FFFFFF" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pySembrane</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="Examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Example 2: Rigorous evaluation of membrane gas separation process based on economic analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Example2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="example-2-rigorous-evaluation-of-membrane-gas-separation-process-based-on-economic-analysis">
<h1>Example 2: Rigorous evaluation of membrane gas separation process based on economic analysis<a class="headerlink" href="#example-2-rigorous-evaluation-of-membrane-gas-separation-process-based-on-economic-analysis" title="Permalink to this heading"></a></h1>
<section id="example-description">
<h2>Example description<a class="headerlink" href="#example-description" title="Permalink to this heading"></a></h2>
<p>In the second example, a robust evaluation using process optimization was conducted on the selected potential MOFs, leading to the identification of the most economically efficient MOF. Given the inherent variations in productivity and economic feasibility based on process conditions, an algorithm for process optimization was implemented. This algorithm minimizes the leveled cost of hydrogen (LCOH) production for each MOF, enabling an unbiased comparison of economic feasibility. The optimization considered four decision variables: feed flow rate, feed pressure, module length, and module diameter, each of which had a substantial influence over process performance. The optimal MOF was determined based on the results of this optimization. The objective function aimed to minimize LCOH, excluding conditions where product purity fell below 99.9%. To enhance algorithm convergence, a penalty was defined, representing the difference between the threshold and calculated purity.</p>
<a class="reference internal image-reference" href="_images/Casestudy2.png"><img alt="Casestudy2" class="align-center" src="_images/Casestudy2.png" style="width: 700px;" /></a>
</section>
<hr class="docutils" />
<section id="method">
<h2>Method<a class="headerlink" href="#method" title="Permalink to this heading"></a></h2>
<p>In this example, process optimization and economic evaluation are performed on the potential MOF determined in the previous example and the best MOF is selected. Figure ref{fig:Casestudy2Algorithm} outlines an algorithm for minimizing the levelized cost of hydrogen (LCOH) by optimizing process variables based on membrane properties. The algorithm comprises two sub-loops. Initially, process simulations are executed based on membrane properties and decision variables, evaluating whether purity constraints are met for a given condition of the product. If purity fails to meet the criteria on either the permeate or retentate side, the algorithm iteratively updates the decision variables. Meanwhile, if the purity constraints are satisfied on either side, an economic evaluation loop is executed. Within this loop, the results analysis module calculates the total annual cost (TAC) and derives LCOH using the equation:</p>
<div class="math notranslate nohighlight">
\[LCOH = \frac{TAC}{Yearly \ H_2 \ production}\]</div>
<p>The adjustment of decision variables persists until the minimum LCOH is attained. In this example, the differential evolution method was employed for process optimization. Differential evolution (DE) is a stochastic optimization algorithm widely employed for solving optimization problems. Modeled after natural selection, DE involves the evolution of candidate solutions (individuals) in a population across generations to uncover optimal solutions for a specified problem cite{das2010differential}. DE efficiently addresses a broad spectrum of optimization issues owing to its simplicity, resilience, and efficacy. It excels in addressing problems featuring nonlinear and multimodal objective functions, surpassing the limitations of conventional gradient-based methods. Hence, DE was chosen to address the complex optimization problem in this example, implemented using the open-source Python package, mintinline{python}{scipy}. The decision variables encompass the flow rate ($F_f$) and pressure ($P_f$) of the feed side, and the length ($L$) and diameter ($D_m$) of the module, each with predefined boundaries: 0.05 mol/s $&lt; F_f &lt;$ 1 mol/s, 10 bar $&lt; P_f &lt;$ 30 bar, 0.1 m $&lt; L &lt;$ 0.6 m, and 0.27 m $&lt; D_m &lt;$ 0.3 m. The objective function is formulated to minimize the sum of LCOH and a constraint penalty, where the latter is expressed as the square of the difference between the purity threshold and the derived product purity. This example demonstrates the application of mintinline{python}{pySembrane} in the realms of optimization and membrane evaluation.</p>
<a class="reference internal image-reference" href="_images/Casestudy2Algorithm.png"><img alt="Casestudy2Algorithm" class="align-center" src="_images/Casestudy2Algorithm.png" style="width: 200px;" /></a>
</section>
<hr class="docutils" />
<section id="results-analysis">
<h2>Results analysis<a class="headerlink" href="#results-analysis" title="Permalink to this heading"></a></h2>
<p>Figure ref{fig:Casestudy2}(b) shows the membrane selectivity and optimal LCOH of 25 materials among potential MOFs, and the rest of these are referred to in SI. The most promising MOF, NIJZOV cite{mao1997synthesis}, exhibited an LCOH of 0.99 USD/kmol, while HIBGIJ cite{samsonenko2007microporous} MOF showed the lowest economic feasibility. Interestingly, MURCOR cite{rizzi2002carboxylate} MOF, despite its lower selectivity compared to VIXGEQ cite{hamdouni2013synthesis} MOF, proved to be more economically feasible, underscoring that selectivity alone may not dictate process viability. This indicates, as observed in previous results, that membrane selectivity may not perfectly represent performance in actual processes. The results for the 47 potential MOFs are available in the SI.
Figure ref{fig:Casestudy2}(c) shows a comparison of decision variables and process performance before and after the process optimization of the most promising MOF. Initially, the H$_2$ purity was 99.91%, exceeding the 99.9% threshold by 0.01%. Process optimization focused on narrowing this purity margin, leading to reduced production costs. Consequently, the LCOH was reduced by 13.9%, declining from 1.15 USD/kg to 0.99 USD/kg. This reduction primarily resulted from notable decreases in feed flow rate and pressure among the four decision variables. Productivity increased as the flow rate of H$_2$ discarded to the retentate side decreased, and total annual cost decreased as energy consumption lowered by reducing feed pressure.</p>
<a class="reference internal image-reference" href="_images/SI_Ex2_results.png"><img alt="SI_Ex2_results" class="align-center" src="_images/SI_Ex2_results.png" style="width: 700px;" /></a>
</section>
<hr class="docutils" />
<section id="sensitivity-analysis">
<h2>Sensitivity analysis<a class="headerlink" href="#sensitivity-analysis" title="Permalink to this heading"></a></h2>
<p>The sensitivity of LCOH and H$_2$ purity concerning the four decision variables is shown in Figure ref{fig:Casestudy2}(d) and (e). The results represent the impact of each decision variable on LCOH and product purity for the best MOF membrane, and the x-axis denotes the optimal value after optimization, ranging from -30% to +30% of the optimal value. The gray area refers to an infeasible condition where product purity falls below 99.9%. As depicted in Figure ref{fig:Casestudy2}(d), LCOH is sensitive to the sequence of module length, feed flow rate, pressure, and module diameter. Conversely, Figure ref{fig:Casestudy2}(e) indicates that product purity is sensitive in the order of feed flow rate, pressure, module length, and module diameter. This sensitivity arises due to the inherent trade-off relationship between product purity and process economics. For instance, the increase in production on the permeate side has a more pronounced impact on LCOH than the rise in process installation cost due to an increase in module length. However, the production increase on the permeate side by longer modules is caused by the large permeation of N$_2$ and results in reduced H$_2$ purity, leading to an infeasible condition. Conversely, feed pressure exhibits a convex shape based on the optimal value. This trend arises from decreased energy consumption with lower feed pressure, accompanied by a decrease in H$_2$ production, and increasing LCOH. Also, the opposite condition in which feed pressure increases is the same.
Figures ref{fig:Casestudy2}(f) and (g) present the sensitivity analysis results for module length and feed flow rate, which are the most sensitive variables to LCOH and product purity, respectively. Module length demonstrates an inversely proportional trend with LCOH, showing less sensitivity in materials with higher economic efficiency. On the contrary, product purity exhibits an increasing trend with the rise in feed flow rate, especially in materials with higher economic efficiency, indicating higher sensitivity.
The following Figures ref{fig:Casestudy2}(h) and (i) illustrate the impact of feed pressure and module length on the process performance of the optimal MOF. Similar to Figures ref{fig:Casestudy2}(d–g), an increase in module length leads to a decrease in both LCOH and purity. In contrast, the relationship between feed pressure and LCOH initially shows a steady decrease with increasing module length, becoming more concave at longer lengths. This implies that the optimal feed pressure changes with module length, decreasing as the module length increases. Notably, at module lengths of 200 mm and 300 mm, the H$_2$ purity at the point with the lowest LCOH could not exceed the threshold, 99.9% of H$_2$. This means that fixing the module length at 200 mm and feed pressure at 15 bar might exclude the MOF identified as best in this study from the list of potential candidates.
The results emphasize that optimal process conditions vary based on the characteristics of each membrane. Hence, evaluating membranes under fixed conditions could lead to biased decisions. Tailoring operating conditions to the specific characteristics of each membrane enables a more accurate evaluation. Additionally, understanding the precise sensitivity of LCOH and product purity under different conditions provides valuable insights for future process optimization and design, enhancing the overall understanding of membrane behavior in various scenarios.</p>
<a class="reference internal image-reference" href="_images/SI_Ex2_SA.png"><img alt="SI_Ex2_SA" class="align-center" src="_images/SI_Ex2_SA.png" style="width: 700px;" /></a>
</section>
<hr class="docutils" />
<section id="source-code">
<h2>Source code<a class="headerlink" href="#source-code" title="Permalink to this heading"></a></h2>
<p>Initially, import pySembrane package and the necessary libraries for data processing, optimization, and visualization. Load the H$_2$ purity data for each MOF derived from Example 1, and from this, select MOFs where the product purity exceeds 99.9%. The .csv file loaded in the code below can be downloaded from GitHub or obtained by executing Example 1.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### Data import ###</span>
<span class="kn">from</span> <span class="nn">simulator</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">differential_evolution</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;240219_Casestudy1_results.csv&#39;</span><span class="p">)</span>
<span class="n">pot_MOF</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Pu_perm_0.7&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.999</span><span class="p">]</span>
<span class="n">pot_MOF</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<p>Define parameters for conducting process simulations throughout the example. In this example, the feed flow rate and pressure, and module length and diameter are not specified as these are the decision variables for the process optimization.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### Module design ###</span>
<span class="n">n_component</span> <span class="o">=</span> <span class="mi">2</span>               <span class="c1"># number of gas components</span>
<span class="n">configuration</span> <span class="o">=</span> <span class="s1">&#39;COFS&#39;</span>        <span class="c1"># module configuration</span>
<span class="n">L</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="mf">1e3</span>                   <span class="c1"># fiber length (mm)</span>
<span class="n">D_module</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">1e3</span>            <span class="c1"># Module diameter (mm)</span>
<span class="n">N_fiber</span> <span class="o">=</span> <span class="mi">100</span>                 <span class="c1"># number of fiber (-)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>                       <span class="c1"># number of nodes (-)</span>

<span class="c1">### Membrane property ###</span>
<span class="n">D_inner</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="mf">1e-1</span>            <span class="c1"># Membrane inner diameter (mm)</span>
<span class="n">D_outer</span> <span class="o">=</span> <span class="mi">250</span><span class="o">*</span><span class="mf">1e-1</span>            <span class="c1"># Membrane outer diameter (mm)</span>

<span class="c1">### Gas property ###</span>
<span class="n">Mw_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2e-3</span><span class="p">,</span> <span class="mf">28e-3</span><span class="p">])</span>                 <span class="c1"># molar weight (kg/mol)</span>
<span class="n">rho_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.08988</span><span class="p">,</span> <span class="mf">1.1606</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-9</span>       <span class="c1"># density (kg/mm3)</span>
<span class="n">mu_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.94e-3</span><span class="p">,</span> <span class="mf">1.89e-3</span><span class="p">])</span>            <span class="c1"># viscosity (Pa s)</span>

<span class="c1">### Mass transfer property ###</span>
<span class="n">k_mass</span> <span class="o">=</span> <span class="mf">1e-1</span>              <span class="c1"># Mass transfer coeff. (mm/s)</span>

<span class="c1">### Operating conditions ###</span>
<span class="c1"># Boundary conditions</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">273</span>                             <span class="c1"># temperature (K)</span>
<span class="n">y_feed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>     <span class="c1"># mole fraction (H2, N2)</span>
</pre></div>
</div>
<p>Define parameters used for the economic assessment of the membrane process.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### Economic analysis parameters ###</span>
<span class="n">MODP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">/</span><span class="mi">1000000</span>       <span class="c1"># Total membrane module cost (US$/ft2)</span>
<span class="n">mem_life</span> <span class="o">=</span> <span class="mi">4</span>            <span class="c1"># membrane life (years)</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">5</span>                   <span class="c1"># project year</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">0.1</span>                 <span class="c1"># interest rate (%)</span>
<span class="n">R_gas</span> <span class="o">=</span> <span class="mf">8.314</span>           <span class="c1"># Gas constant (J/K mol)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.4</span>                 <span class="c1"># Heat capacity ratio</span>
<span class="n">effi_ref</span> <span class="o">=</span> <span class="mf">0.8</span>          <span class="c1"># compressor efficiency</span>
</pre></div>
</div>
<p>Define an objective function for the optimization of four process variables aimed at minimizing the Levelized Cost of Hydrogen (LCOH). Firstly, the function takes decision variables to perform a membrane process simulation. Subsequently, it defines the system’s outlet streams (F_perm, F_ret) to derive H2 purity after the process simulation terminated. If the product purity under given conditions exceeds 99.9%, an economic assessment is performed, and the LCOH is derived. The squared difference between the calculated purity and the threshold is defined as a penalty, optimizing to minimize both LCOH and penalty. If purity does not exceed 99.9%, it returns a significantly large value, indicating an infeasible condition.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### Objective function for LCOH minimization ###</span>
<span class="k">def</span> <span class="nf">ObjFunc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">ff</span><span class="p">,</span> <span class="n">pf</span><span class="p">,</span> <span class="n">ll</span><span class="p">,</span> <span class="n">D_m</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">mem</span> <span class="o">=</span> <span class="n">MembraneProc</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="n">ll</span><span class="p">,</span> <span class="n">D_m</span><span class="p">,</span> <span class="n">N_fiber</span><span class="p">,</span>
                    <span class="n">n_component</span><span class="p">,</span> <span class="n">n_node</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">membrane_info</span><span class="p">(</span><span class="n">a_perm</span><span class="p">,</span> <span class="n">D_inner</span><span class="p">,</span> <span class="n">D_outer</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">gas_prop_info</span><span class="p">(</span><span class="n">Mw_i</span><span class="p">,</span> <span class="n">mu_i</span><span class="p">,</span> <span class="n">rho_i</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">mass_trans_info</span><span class="p">(</span><span class="n">k_mass</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">boundaryC_info</span><span class="p">(</span><span class="n">y_feed</span><span class="p">,</span> <span class="n">pf</span><span class="p">,</span> <span class="n">ff</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">initialC_info</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">run_mem</span><span class="p">(</span><span class="n">cp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cp_cond</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">298</span><span class="p">])</span>

    <span class="n">F_perm</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_component</span><span class="p">:</span><span class="n">n_component</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">F_ret</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">n_component</span><span class="p">]</span>

    <span class="n">F_perm</span><span class="p">[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_feed</span><span class="o">*</span><span class="n">y_feed</span><span class="p">)[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">F_ret</span><span class="p">[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pu_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">flow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="p">[</span><span class="n">F_ret</span><span class="p">,</span> <span class="n">F_perm</span><span class="p">]]</span>

    <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">pu_list</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.999</span><span class="p">:</span>
        <span class="n">penalty</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">pu_list</span><span class="p">)</span><span class="o">-</span><span class="mf">0.999</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">lcoh</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">CalculTAC</span><span class="p">(</span><span class="n">MODP</span><span class="p">,</span> <span class="n">mem_life</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">effi_ref</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">F_perm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">28800000</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>
                <span class="c1"># USD / kmol H2</span>
        <span class="k">return</span> <span class="n">lcoh</span><span class="o">+</span><span class="n">penalty</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">lcoh</span> <span class="o">=</span> <span class="mf">1e30</span>
        <span class="n">penalty</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pu_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lcoh</span><span class="o">/</span><span class="n">penalty</span>
</pre></div>
</div>
<p>Set the boundaries for the four decision variables and perform optimization. A ‘for’ loop individually explores optimal values for each MOF, defining the target MOF and repeating optimization. Upon completion, save the determined process variable values and LCOH, exporting them to a .csv file. The simulation results can be downloaded from GitHub or obtained by executing the code below. Note that the differential evolution method used for optimization introduces randomness, which may result in slight variations in computational outcomes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">),(</span><span class="n">L</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="p">(</span><span class="n">D_module</span><span class="o">/</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">D_module</span><span class="o">*</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">proc_cond</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">mssg_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lcoh_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pot_MOF</span><span class="p">)):</span>
    <span class="n">target_mof</span> <span class="o">=</span> <span class="n">pot_MOF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span>
    <span class="n">a_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">target_mof</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a_H2(mol/(mm^2 bar s))&#39;</span><span class="p">,</span> <span class="s1">&#39;a_N2(mol/(mm^2 bar s))&#39;</span><span class="p">]])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span><span class="n">ObjFunc</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
                                <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">)</span>
    <span class="n">proc_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    <span class="n">mssg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>
    <span class="n">lcoh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span>

<span class="n">pot_MOF</span><span class="p">[[</span><span class="s1">&#39;Ff_opt&#39;</span><span class="p">,</span> <span class="s1">&#39;Pf_opt&#39;</span><span class="p">,</span> <span class="s1">&#39;L_opt&#39;</span><span class="p">,</span> <span class="s1">&#39;D_opt&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proc_cond</span><span class="p">)</span>
<span class="n">pot_MOF</span><span class="p">[</span><span class="s1">&#39;LCOH_opt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lcoh_list</span>

<span class="n">pot_MOF</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;240221_Casestudy2_results.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>To verify the optimization results, derive the product’s purity for the determined process variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex2_res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;240221_Casestudy2_results.csv&#39;</span><span class="p">)</span>
<span class="n">lcoh_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pu_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ex2_res</span><span class="p">)):</span>
    <span class="n">target_mof</span> <span class="o">=</span> <span class="n">ex2_res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span>
    <span class="n">ff_opt</span><span class="p">,</span> <span class="n">pf_opt</span><span class="p">,</span> <span class="n">l_opt</span><span class="p">,</span> <span class="n">dm_opt</span> <span class="o">=</span> <span class="n">target_mof</span><span class="p">[[</span><span class="s1">&#39;Ff_opt&#39;</span><span class="p">,</span> <span class="s1">&#39;Pf_opt&#39;</span><span class="p">,</span> <span class="s1">&#39;L_opt&#39;</span><span class="p">,</span> <span class="s1">&#39;D_opt&#39;</span><span class="p">]]</span>
    <span class="n">a_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">target_mof</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a_H2(mol/(mm^2 bar s))&#39;</span><span class="p">,</span> <span class="s1">&#39;a_N2(mol/(mm^2 bar s))&#39;</span><span class="p">]])</span>
    <span class="n">mem</span> <span class="o">=</span> <span class="n">MembraneProc</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="n">l_opt</span><span class="p">,</span> <span class="n">dm_opt</span><span class="p">,</span> <span class="n">N_fiber</span><span class="p">,</span>
                    <span class="n">n_component</span><span class="p">,</span> <span class="n">n_node</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">membrane_info</span><span class="p">(</span><span class="n">a_perm</span><span class="p">,</span> <span class="n">D_inner</span><span class="p">,</span> <span class="n">D_outer</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">gas_prop_info</span><span class="p">(</span><span class="n">Mw_i</span><span class="p">,</span> <span class="n">mu_i</span><span class="p">,</span> <span class="n">rho_i</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">mass_trans_info</span><span class="p">(</span><span class="n">k_mass</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">boundaryC_info</span><span class="p">(</span><span class="n">y_feed</span><span class="p">,</span> <span class="n">pf_opt</span><span class="p">,</span> <span class="n">ff_opt</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">initialC_info</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">run_mem</span><span class="p">(</span><span class="n">cp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cp_cond</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">298</span><span class="p">])</span>

    <span class="n">F_perm</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_component</span><span class="p">:</span><span class="n">n_component</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">F_ret</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">n_component</span><span class="p">]</span>
    <span class="n">F_perm</span><span class="p">[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ff_opt</span><span class="o">*</span><span class="n">y_feed</span><span class="p">)[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">F_ret</span><span class="p">[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">pu_</span> <span class="o">=</span> <span class="p">[</span><span class="n">flow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="p">[</span><span class="n">F_ret</span><span class="p">,</span> <span class="n">F_perm</span><span class="p">]]</span>
    <span class="n">pu_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pu_</span><span class="p">)</span>
    <span class="n">LCOH</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">CalculTAC</span><span class="p">(</span><span class="n">MODP</span><span class="p">,</span> <span class="n">mem_life</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">effi_ref</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">F_perm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">28800000</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>
    <span class="n">lcoh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LCOH</span><span class="p">)</span>
<span class="n">ex2_res</span><span class="p">[[</span><span class="s1">&#39;Pu_ret_opt&#39;</span><span class="p">,</span><span class="s1">&#39;Pu_perm_opt&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pu_list</span><span class="p">)</span>
</pre></div>
</div>
<p>Below is the code for visualizing the optimization results for 47 potential MOFs, allowing for the observation of trends between the optimal LCOH and membrane selectivity for each MOF.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt_sort</span> <span class="o">=</span> <span class="n">ex2_res</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;LCOH_opt&#39;</span><span class="p">)</span>

<span class="n">ads_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">_name</span> <span class="ow">in</span> <span class="n">opt_sort</span><span class="p">[</span><span class="s1">&#39;Adsorbent&#39;</span><span class="p">]]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ads_names</span><span class="p">,</span> <span class="n">opt_sort</span><span class="p">[</span><span class="s1">&#39;P_H2(Barrer)&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">opt_sort</span><span class="p">[</span><span class="s1">&#39;P_N2(Barrer)&#39;</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span><span class="s1">&#39;S$\mathrm{_{H_2/N_2}}$&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ads_names</span><span class="p">,</span><span class="n">opt_sort</span><span class="p">[</span><span class="s1">&#39;LCOH_opt&#39;</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LCOH&#39;</span><span class="p">)</span>

<span class="n">plots</span> <span class="o">=</span> <span class="n">line</span><span class="o">+</span> <span class="p">[</span><span class="n">bar</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">plots</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">3.5e3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">ads_names</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;S$\mathrm{_{H_2/N_2}}$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;LCOH [USD/kmol]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The following codes perform sensitivity analysis from various perspectives to analyze the impact of decision variables on LCOH and product purity. Firstly, by executing the code below, can analyze the influence of each variable on the performance of the best MOF.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### Sensitivity analysis ###</span>
<span class="n">rr_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
<span class="n">rr_case</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rr_list</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">insert_idx</span><span class="p">,</span> <span class="n">ratio_idx</span><span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">rr_list</span><span class="p">))</span>
    <span class="n">_tmp</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_idx</span><span class="p">,</span><span class="n">rr_list</span><span class="p">[</span><span class="n">ratio_idx</span><span class="p">])</span>
    <span class="n">rr_case</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_tmp</span><span class="p">)</span>

<span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Feed flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;Feed pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Module length&#39;</span><span class="p">,</span> <span class="s1">&#39;Module diameter&#39;</span><span class="p">]</span>
<span class="n">x_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-30%&#39;</span><span class="p">,</span> <span class="s1">&#39;-15%&#39;</span><span class="p">,</span> <span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;+15%&#39;</span><span class="p">,</span> <span class="s1">&#39;+30%&#39;</span><span class="p">]</span>
<span class="n">c_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>

<span class="n">best_mof</span> <span class="o">=</span> <span class="n">opt_sort</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">sa_res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f_fac</span><span class="p">,</span> <span class="n">p_fac</span><span class="p">,</span> <span class="n">l_fac</span><span class="p">,</span> <span class="n">d_fac</span> <span class="ow">in</span> <span class="n">rr_case</span><span class="p">:</span>
    <span class="n">F_feed</span><span class="p">,</span> <span class="n">P_feed</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Dm</span> <span class="o">=</span> <span class="n">best_mof</span><span class="p">[</span><span class="s1">&#39;Ff_opt&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">f_fac</span><span class="p">,</span> <span class="n">best_mof</span><span class="p">[</span><span class="s1">&#39;Pf_opt&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">p_fac</span><span class="p">,</span> <span class="n">best_mof</span><span class="p">[</span><span class="s1">&#39;L_opt&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">l_fac</span><span class="p">,</span> <span class="n">best_mof</span><span class="p">[</span><span class="s1">&#39;D_opt&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">d_fac</span>
    <span class="n">a_H2</span><span class="p">,</span> <span class="n">a_N2</span> <span class="o">=</span> <span class="n">best_mof</span><span class="p">[[</span><span class="s1">&#39;a_H2(mol/(mm^2 bar s))&#39;</span><span class="p">,</span> <span class="s1">&#39;a_N2(mol/(mm^2 bar s))&#39;</span><span class="p">]]</span>
    <span class="n">a_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a_H2</span><span class="p">,</span> <span class="n">a_N2</span><span class="p">])</span>

    <span class="n">mem</span> <span class="o">=</span> <span class="n">MembraneProc</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Dm</span><span class="p">,</span> <span class="n">N_fiber</span><span class="p">,</span>
                    <span class="n">n_component</span><span class="p">,</span> <span class="n">n_node</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">membrane_info</span><span class="p">(</span><span class="n">a_perm</span><span class="p">,</span> <span class="n">D_inner</span><span class="p">,</span> <span class="n">D_outer</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">gas_prop_info</span><span class="p">(</span><span class="n">Mw_i</span><span class="p">,</span> <span class="n">mu_i</span><span class="p">,</span> <span class="n">rho_i</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">mass_trans_info</span><span class="p">(</span><span class="n">k_mass</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">boundaryC_info</span><span class="p">(</span><span class="n">y_feed</span><span class="p">,</span> <span class="n">P_feed</span><span class="p">,</span> <span class="n">F_feed</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">mem</span><span class="o">.</span><span class="n">initialC_info</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">run_mem</span><span class="p">(</span><span class="n">cp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cp_cond</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">298</span><span class="p">])</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">MassBalance</span><span class="p">()</span>

    <span class="n">F_perm</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_component</span><span class="p">:</span><span class="n">n_component</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">F_ret</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">n_component</span><span class="p">]</span>
    <span class="n">F_perm</span><span class="p">[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_feed</span><span class="o">*</span><span class="n">y_feed</span><span class="p">)[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">F_ret</span><span class="p">[</span><span class="n">F_ret</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">lcoh</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">CalculTAC</span><span class="p">(</span><span class="n">MODP</span><span class="p">,</span> <span class="n">mem_life</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">effi_ref</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">F_perm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">28800000</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>
    <span class="n">sa_res</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">F_feed</span><span class="p">,</span><span class="n">P_feed</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Dm</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">err</span><span class="p">,</span> <span class="n">lcoh</span><span class="p">])</span>
<span class="n">sens_lcoh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sa_res</span><span class="p">)</span>
</pre></div>
</div>
<p>Below is the code for plotting the sensitivity analysis results for the best MOF, which, upon execution, yields Figures 5(d) and (e).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### Sensitivity analysis plot ###</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">res_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sens_lcoh</span><span class="p">[</span><span class="n">ii</span><span class="o">*</span><span class="mi">5</span><span class="p">:(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_labels</span><span class="p">,</span> <span class="n">res_plot</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">var_name</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_list</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">best_mof</span><span class="p">[</span><span class="s1">&#39;LCOH_opt&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;LCOH [USD/kmol]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">res_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sens_lcoh</span><span class="p">[</span><span class="n">ii</span><span class="o">*</span><span class="mi">5</span><span class="p">:(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">,:])</span>
    <span class="n">purity_plot</span> <span class="o">=</span> <span class="n">res_plot</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">res_plot</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">res_plot</span><span class="p">[:,</span><span class="mi">7</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_labels</span><span class="p">,</span> <span class="n">purity_plot</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">var_name</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_list</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">99.9</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Purity (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<hr class="docutils" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Example1.html" class="btn btn-neutral float-left" title="Example 1: Numerous membrane screening" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Example3.html" class="btn btn-neutral float-right" title="Example 3: Integrated process simulations with other processes for process level evaluation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, NahyeonAn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>